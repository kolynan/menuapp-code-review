# Commands executed during PublicMenu bug fixes session
# Date: 2026-02-23

# 1. Stage and commit uncommitted changes
git add pages/PublicMenu/CartView.jsx
git commit -m "update PublicMenu_BASE and CartView before bug fixes"
git push

# 2. BUG 1 fix: setView("cart") -> setView("menu") in processHallOrder
# Edit: line ~1635 in PublicMenu_BASE.txt
git add pages/PublicMenu/PublicMenu_BASE.txt
git commit -m "fix: hall order sets valid view state instead of unmapped 'cart'"

# 3. BUG 2 fix: Add 300ms delay before view transition after pickup/delivery order
# Edit: lines ~1932-1938 in PublicMenu_BASE.txt
git add pages/PublicMenu/PublicMenu_BASE.txt
git commit -m "fix: add brief delay before view transition after pickup/delivery order"

# 4. BUG 3 fix: Add isSessionLoading flag and guard in StickyCartBar
# Edit: lines ~1147, ~1158-1166, ~2414-2420 in PublicMenu_BASE.txt
git add pages/PublicMenu/PublicMenu_BASE.txt
git commit -m "fix: handle loading state in StickyCartBar after page refresh"

# 5. Push all fixes
git push

# 6. Review phase
# - correctness-reviewer subagent on PublicMenu_BASE.txt
# - style-reviewer subagent on PublicMenu_BASE.txt
# - codex exec on git diff HEAD~3..HEAD

git diff HEAD~3..HEAD -- pages/PublicMenu/PublicMenu_BASE.txt
codex exec "Review this diff for bugs and race conditions. Be very concise (max 10 lines). <diff>"

# 7. Fix reviewer findings
# Edit: Added viewTransitionTimerRef + cleanup useEffect (line ~558)
# Edit: Updated setTimeout to use ref (line ~1940)
# Edit: Added sessionCheckTimedOut 3s timeout (line ~1148)
# Edit: Fixed processHallOrder comment (line ~1639)
# Edit: Added isDrawerOpen prop, removed dead buttonLabel override (line ~2430)
git add pages/PublicMenu/PublicMenu_BASE.txt
git commit -m "fix(review): address reviewer findings for 3 bug fixes"
git push
