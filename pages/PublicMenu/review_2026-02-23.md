# Code Review Report: MenuView.jsx — Photo Drawer Feature

**Date:** 2026-02-23
**Reviewed by:** Claude (correctness-reviewer + style-reviewer)
**Feature:** Photo Drawer (bottom sheet on photo tap)
**Commits reviewed:** 5d6e3c7..efccdd8 (5 implementation commits)

---

## Summary

Photo drawer feature implemented across 5 commits: state, tappable photos, drawer component, JSX rendering, body scroll lock. Both reviewers found issues — all were fixed in a single review commit (e201db3).

---

## Issues Found & Fixed

### P0 — Critical (3 issues, all FIXED)

| # | Issue | Location | Fix |
|---|-------|----------|-----|
| 1 | Hardcoded Russian fallback `\|\| 'Добавить'` in drawer add button | line ~301 | Removed fallback, use `t('menu.add')` only |
| 2 | Hardcoded Russian fallback `\|\| 'Плитка'` in layout toggle | line ~342 | Removed fallback, use `t('menu.tile')` only |
| 3 | Hardcoded Russian fallback `\|\| 'Список'` in layout toggle | line ~353 | Removed fallback, use `t('menu.list')` only |

### P1 — High Priority (4 issues found, 2 FIXED, 2 DEFERRED)

| # | Issue | Location | Status |
|---|-------|----------|--------|
| 1 | Scroll lock stomps sibling overflow on cleanup | lines 46-53 | **FIXED** — save/restore prev overflow |
| 2 | z-50 may be covered by sticky cart/chips | lines 241, 246 | **FIXED** — bumped to z-[60] |
| 3 | `cart` prop has no default — crashes if undefined | destructured props | DEFERRED — pre-existing, separate task |
| 4 | Empty category array renders empty section | line 364-365 | DEFERRED — pre-existing, separate task |

### P2 — Medium (6 issues found, 4 FIXED, 2 DEFERRED)

| # | Issue | Location | Status |
|---|-------|----------|--------|
| 1 | Dynamic Tailwind class interpolation (fragile space) | lines 76, 157 | **FIXED** — space moved outside conditional |
| 2 | Close button missing aria-label | line ~248 | **FIXED** — added `aria-label={t('common.close')}` |
| 3 | Unicode ✕ instead of Lucide X icon | line ~252 | **FIXED** — replaced with `<X>` icon, added import |
| 4 | Overlay missing aria-hidden, drawer missing role/aria-modal/Escape | lines 240-246 | **FIXED** — added role="dialog", aria-modal, Escape handler |
| 5 | Touch targets for list/tile stepper buttons < 44px | lines 126-139 | DEFERRED — noted as separate task per prompt |
| 6 | Duplicate cart.find in 3 locations | lines 66, 149, 235 | DEFERRED — minor DRY, out of scope |

### P3 — Low Priority (2 issues, 1 FIXED, 1 DEFERRED)

| # | Issue | Location | Status |
|---|-------|----------|--------|
| 1 | Unicode escape for close icon | line ~252 | **FIXED** — replaced with Lucide X |
| 2 | `renderXxx` naming convention (class-era pattern) | function names | DEFERRED — cosmetic, low priority |

---

## Statistics

- **Total issues found:** 15
- **Fixed in this session:** 9 (P0: 3, P1: 2, P2: 4, P3: 1 overlap)
- **Deferred (pre-existing / out of scope):** 6
- **Files analyzed:** 1
- **Lines of code:** ~407
- **Commits:** 5 implementation + 1 review fix = 6 total

---

## Deferred Issues (for future tasks)

1. **cart prop default** — Add `cart = []` in destructured props to prevent crash if prop is undefined
2. **Empty category guard** — Add `categoryDishes.length === 0` check to hide empty sections
3. **Touch targets in list/tile steppers** — Increase from `p-1` (~24px) to `w-11 h-11` (44px)
4. **DRY cart.find** — Extract `getCartItem(dishId)` helper
5. **key prop on render functions** — Move key to .map() call site or extract as named components
6. **renderXxx naming** — Consider extracting as named components (`ListCard`, `TileCard`)
