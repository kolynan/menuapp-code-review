---
version: "1.1"
updated: "2026-03-01"
session: 59
---

# PartnerShell — Обёртка партнёрского кабинета

## Описание
Главная обёртка (shell/layout) для всех страниц партнёрского кабинета. Управляет аутентификацией, проверкой доступа (STAFF-015..020), навигацией между вкладками, выбором языка и контекстом `usePartnerAccess`.

**Route:** Все partner routes (`/partnerhome`, `/partnersettings`, etc.)
**Roles:** Owner, Staff (с разными уровнями доступа)
**Размер:** ~425 строк

## Entities
- **Partner** — read (загрузка данных партнёра)
- **StaffAccessLink** — read (проверка доступа сотрудника)
- **User** — read (текущий пользователь)

## Ключевые паттерны
- `PartnerAccessContext` — контекст с ролью, partnerID, данными партнёра
- Rate-limit detection — автоматическая отмена запросов при 429
- Tab navigation — responsive (иконки на mobile, текст на desktop)
- i18n — полная локализация через `useI18n()`

## RELEASE History

| Version | Date | Changes |
|---------|------|---------|
| 260222-00 | 2026-02-22 | Code review: 15 patches (5×P1, 7×P2, 3×P3) |
| 260301-00 | 2026-03-01 | UX: Settings added to hamburger menu |

## UX Changelog

| Дата | Версия | Что изменилось |
|------|--------|----------------|
| 2026-02-22 | 260222-00 | Исправлен flash AccessDenied для сотрудников; корректный редирект на логин; улучшена доступность навигации |
| 2026-03-01 | 260301-00 | Добавлен пункт "Настройки" в гамбургер-меню для быстрого доступа к настройкам |
